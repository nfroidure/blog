<!DOCTYPE html><html lang="fr"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/images/logo.svg"/><link rel="preload" as="image" href="https://raw.githubusercontent.com/nfroidure/knifecycle/main/knifecycle.svg"/><link rel="stylesheet" href="https://insertafter.com/_next/static/css/1f9f2e31c0c7b0ad.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="https://insertafter.com/_next/static/css/c0794213978ef12b.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="https://insertafter.com/_next/static/chunks/webpack-e22d0b50184c3e5b.js" crossorigin=""/><script src="https://insertafter.com/_next/static/chunks/fd9d1056-5bc70f044f3cb802.js" async="" crossorigin=""></script><script src="https://insertafter.com/_next/static/chunks/938-bf741a2eb8fd4828.js" async="" crossorigin=""></script><script src="https://insertafter.com/_next/static/chunks/main-app-2e6280b5273157a5.js" async="" crossorigin=""></script><script src="https://insertafter.com/_next/static/chunks/176-0a03be62efe5672b.js" async=""></script><script src="https://insertafter.com/_next/static/chunks/app/(withLocale)/%5Blocale%5D/layout-6f34dfcd57f7d3e4.js" async=""></script><script src="https://insertafter.com/_next/static/chunks/876-4c07c683293830f5.js" async=""></script><script src="https://insertafter.com/_next/static/chunks/app/(withLocale)/%5Blocale%5D/blog/%5Bid%5D/page-8c92e4ed1884a050.js" async=""></script><meta name="theme-color" content="#3e78b2"/><title>Injection de d√©pendances avec NodeJS  - Nicolas Froidure</title><meta name="description" content="Pr√©sentation donn√©e lors du ChtiJS 21 √† propos de l&#x27;injection de d√©pendances en JavaScript."/><link rel="author" href="https://insertafter.com"/><meta name="author" content="Nicolas Froidure"/><meta name="robots" content="index, follow"/><link rel="canonical" href="https://insertafter.com/fr/blog/injection_de_dependance_nodejs"/><meta property="og:title" content="Injection de d√©pendances avec NodeJS  - Nicolas Froidure"/><meta property="og:description" content="Pr√©sentation donn√©e lors du ChtiJS 21 √† propos de l&#x27;injection de d√©pendances en JavaScript."/><meta property="og:url" content="https://insertafter.com/fr/blog/injection_de_dependance_nodejs"/><meta property="og:site_name" content="Nicolas Froidure"/><meta property="og:locale" content="fr_FR"/><meta property="og:image:alt" content="Banni√®re du site"/><meta property="og:image" content="https://insertafter.com/images/banner.png"/><meta property="og:type" content="article"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@nfroidure"/><meta name="twitter:creator" content="@nfroidure"/><meta name="twitter:title" content="Injection de d√©pendances avec NodeJS  - Nicolas Froidure"/><meta name="twitter:description" content="Pr√©sentation donn√©e lors du ChtiJS 21 √† propos de l&#x27;injection de d√©pendances en JavaScript."/><meta name="twitter:image:alt" content="Banni√®re du site"/><meta name="twitter:image" content="https://insertafter.com/images/banner.png"/><link rel="icon" href="/images/favicon.svg" type="image/svg+xml" sizes="any"/><link rel="icon" href="/images/favicon-16.png" type="image/png" sizes="16x16"/><link rel="icon" href="/images/favicon-128.png" type="image/png" sizes="128x128"/><script src="https://insertafter.com/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="layout_body__jFZuu"><header class="header_iaHeader__4vCMA"><div><h1><a href="/fr" title="Retour √† l‚Äôaccueil" class="header_iaHeaderLogo__0uNr1"><img src="/images/logo.svg" alt="Logo d‚ÄôInsertAfter"/></a></h1></div></header><nav class="menu_iaMenu__B_rtj"><ul class="menu_iaMenuBody__0Zveq"><li class="menu_iaMenuItem__rOch4"><a href="/fr" title="Retour √† l‚Äôaccueil" class="">Accueil</a></li><li class="menu_iaMenuItem__rOch4"><a href="/fr/blog" title="Retour √† l‚Äôindex du blog" class="">Blog</a></li><li class="menu_iaMenuItem__rOch4"><a href="/fr/projets" title="D√©couvrir mes divers projets" class="">Projets</a></li><li class="menu_iaMenuItem__rOch4"><a href="/fr/a_propos" title="En savoir plus √† mon sujet" class="">√Ä propos</a></li></ul></nav><nav class="languages_iaLanguages__K2J3W"><ul><li class="languages_iaLanguagesFlag__ruQ4j languages_iaLanguagesFlagEn__angfJ languages_selected__w1dKv"><a href="/en/blog"><span>en</span></a></li><li class="languages_iaLanguagesFlag__ruQ4j languages_iaLanguagesFlagFr__Us5Jb"><a href="/fr/blog"><span>fr</span></a></li></ul></nav><main class="layout_iaMain__6s2gl"><div><section class="contentBlock_root__802UK"><h1 class="h1_root__VPXQG"><span>Injection de d√©pendances sans gorille</span></h1><div><span class="img_root__vTZoG img_landscape__qBqfT"><span class="img_picture__pfsl0"><img alt="Knifecycle logo" src="https://raw.githubusercontent.com/nfroidure/knifecycle/main/knifecycle.svg"/></span></span></div><p class="p_root__SHE_W"><span class="markdown_root__U7zrI"><iframe width="560" height="315" src="https://www.youtube.com/embed/qTtwn1J9IXk" title="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowFullScreen=""></iframe></span></p><p class="p_root__SHE_W"><span>Retranscription de ma pr√©sentation au dernier ChtiJS sur l&#x27;injection de d√©pendances avec NodeJS mais plus g√©n√©ralement en JavaScript¬†!</span></p><p class="p_root__SHE_W"><div class="slidesDotCom_root__yd21N"><iframe src="https://slides.com/nfroidure/javascript_dependency_injection/embed" allowFullScreen=""></iframe><noscript><a class="a_root__WEPS7" title="Voir les diapositives de la pr√©sentation" target="_blank" href="https://slides.com/nfroidure/javascript_dependency_injection"><span>Slides</span></a></noscript></div></p><p class="p_root__SHE_W"><span>Aujourd&#x27;hui, je vais vous parlais d&#x27;injection de d√©pendances en JavaScript. J&#x27;ai fait les slides en anglais car je vais les mettre sur mon blog apr√®s mais n&#x27;h√©sitez pas √† me demander de traduire si vous en ressentez le besoin.</span></p><p class="p_root__SHE_W"><span>J&#x27;ai pr√©cis√© unobtrusive car l&#x27;objectif est que cette derni√®re n&#x27;interf√®re pas avec votre code. L&#x27;id√©e c&#x27;est d&#x27;avoir un minimum de code qui qui g√®re √ßa puisque finalement vous allez voir que ce n&#x27;est pas n√©cessaire.</span></p><h2 class="h2_root__Y02lX"><span class="anchored_root__HWi6K"><span>A propos de moi</span> <small><a class="anchored_icon__N5Sem" id="a-propos-de-moi" title="Lien vers cette section" href="#a-propos-de-moi"><span>üîó</span></a></small></span></h2><p class="p_root__SHE_W"><span>Faisons d&#x27;abord les pr√©sentations, je travaille pour Sencrop, vous l&#x27;avez vu tout √† l&#x27;heure. Je fais du logiciel pour les startups depuis que JavaScript est un sujet br√ªlant. Et une fois j&#x27;ai fait un code qui a failli compiler avec Rust. Vous pouvez me retrouver sur mon blog ou via Twitter.</span></p><h2 class="h2_root__Y02lX"><span class="anchored_root__HWi6K"><span>Sencrop recrute</span> <small><a class="anchored_icon__N5Sem" id="sencrop-recrute" title="Lien vers cette section" href="#sencrop-recrute"><span>üîó</span></a></small></span></h2><p class="p_root__SHE_W"><span>Vous avez peut-√™tre entendu parler de la lev√©e de fond r√©cente de Sencrop. Du coup, on va pouvoir augmenter nos ambitions et pour ce faire on recrute des d√©veloppeurs back-end, front-end (mais si vous √™tes full-stack c&#x27;est bien aussi, des data scientists et des ing√©nieurs pour le d√©veloppement embarqu√© car on a une probl√©matique hardware √©galement.</span></p><h2 class="h2_root__Y02lX"><span class="anchored_root__HWi6K"><span>D√©finition</span> <small><a class="anchored_icon__N5Sem" id="definition" title="Lien vers cette section" href="#definition"><span>üîó</span></a></small></span></h2><p class="p_root__SHE_W"><span>Qui conna√Æt l&#x27;injection de d√©pendances¬†? Une bonne partie de la salle l√®ve la main. Qui l&#x27;utilise au quotidien¬†? Quelques mains se l√®vent. Une personne: &quot;C&#x27;est un peu la m√™me chose que Spring Boot en Java¬†?&quot; Alors, oui, c&#x27;est design pattern donc tu l&#x27;impl√©mentes comme tu veux, tu peux l&#x27;impl√©menter en POO ou pas.</span></p><p class="p_root__SHE_W"><span>L&#x27;id√©e, en gros, de l&#x27;injection de d√©pendance, c&#x27;est que votre code a besoin de faire appel √† des √©tats externes, donc typiquement √ßa va √™tre les IOs (lire un fichier, enregistrer dans une base de donn√©es, faire un appel √† un service REST, peu importe...).On va donc chercher √† exprimer ces d√©pendances de mani√®re d√©clarative pour que le code m√©tier ne soit pas impact√© par toute la tuyauterie.</span></p><p class="p_root__SHE_W"><span>Finalement, on cherche que l&#x27;impl√©mentation soit compl√®tement d√©coupl√©e des d√©pendances et de leur initialisation.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>En JavaScript</span> <small><a class="anchored_icon__N5Sem" id="en-javascript" title="Lien vers cette section" href="#en-javascript"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Donc, en JS, qu&#x27;est ce que √ßa peut donner¬†? En fait c&#x27;est tr√®s simple, si vous √™tes un fan de la POO, vous avez une classe et cette classe finalement vous allez lui injecter les services dont elle a besoin de mani√®re √† ce qu&#x27;en son sein, vous puissiez utiliser ces services sans vous soucier de leurs initialisation.</span></p><p class="p_root__SHE_W"><span>Avec les fonctions, c&#x27;est un peu plus simple, vous allez utiliser le passage d&#x27;arguments √† vos fonctions et vous allez utiliser, tout b√™tement, les services que vous avez pass√© en argument de vos fonctions.</span></p><p class="p_root__SHE_W"><span>C&#x27;est assez simple, en fait, c&#x27;est un mot compliqu√© pour nommer quelque chose de tr√®s simple.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Cycle de vie d&#x27;une application</span> <small><a class="anchored_icon__N5Sem" id="cycle-de-vie-d-une-application" title="Lien vers cette section" href="#cycle-de-vie-d-une-application"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Pourquoi c&#x27;est utile¬†? (Toute la salle penche la t√™te pour lire les annotations du sch√©ma projet√©). Oui, je vous vois tourner la t√™te, mais j&#x27;avais pas de place pour mettre les √©criteaux horizontalement.</span></p><p class="p_root__SHE_W"><span>Je vous mets au d√©fi de trouver une application qui n&#x27;a pas une phase de d√©marrage et une phase d&#x27;arr√™t, √† part le front-end, encore que, parfois, vous pouvez vouloir qu&#x27;il y ait des comportements au sortir de la page qui soient d√©clench√©s.</span></p><p class="p_root__SHE_W"><span>Du coup c&#x27;est un truc qui est super r√©current et c&#x27;est ce que l&#x27;injection d√©pendance adresse. C&#x27;est donc tr√®s commun de l&#x27;utiliser.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Les phases de l&#x27;injection de d√©pendances</span> <small><a class="anchored_icon__N5Sem" id="les-phases-de-l-injection-de-dependances" title="Lien vers cette section" href="#les-phases-de-l-injection-de-dependances"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Alors, √† quoi √ßa ressemble finalement. Vous avez toutes vos d√©pendances (la fl√®che, ici, elle veut dire &quot;d√©pend de&quot;, donc ce rond l√† d√©pend de cet autre l√†). Chaque n≈ìud est donc un service et les feuilles c&#x27;est le code m√©tier, celui qui exploite vos services.</span></p><p class="p_root__SHE_W"><span>Les d√©penses de votre application, c&#x27;est un graphe orient√© et l&#x27;id√©e, en fait, c&#x27;est finalement qu&#x27;on peut les initialiser d&#x27;une mani√®re optimale. C&#x27;est pas compliqu√©, vous commencez par instancier les services qui n&#x27;ont pas de d√©pendance, puis les services qui d√©pendent des services que vous avez initialis√©s √† la premi√®re it√©ration lors de la seconde it√©ration et √† la troisi√®me it√©ration les services qui vous n&#x27;avez pu cr√©er √† la seconde, etc jusqu&#x27;√† ce que toute votre application soit initialis√©e.</span></p><p class="p_root__SHE_W"><span>Pour l&#x27;extinction, c&#x27;est pareil sauf que l√† vos services, ils sont tous up et vous allez les stopper de mani√®re invers√©e afin que tous les services soient proprement arr√™t√©s. C&#x27;est le &quot;graceful shutdown&quot; pour ceux qui ne connaissent pas. C&#x27;est un probl√©matique plut√¥t back-end mais pourquoi pas en front.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Opinion</span> <small><a class="anchored_icon__N5Sem" id="opinion" title="Lien vers cette section" href="#opinion"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>L&#x27;opinion que j&#x27;ai essayer de d√©velopper ce soir est que c&#x27;est le seul design pattern que vous ne regretterez jamais d&#x27;avoir impl√©menter. Pourquoi¬†? Parce que comme je l&#x27;ai annonc√© tout √† l&#x27;heure, c&#x27;est r√©current, c&#x27;est √† dire que √ßa adresse un probl√®me qui existe dans toutes les applications et donc c&#x27;est dommage de ne pas l&#x27;utiliser surtout quand on le conna√Æt.</span></p><p class="p_root__SHE_W"><span>La deuxi√®me opinion que je vais essayer de d√©velopper est que si vous utilisez de la programmation orient√©e objet ne bl√¢mez pas l&#x27;injection de d√©pendances parce que c&#x27;est pas de sa faute si vous avez l&#x27;impression que c&#x27;est n&#x27;importe quoi, mais celle de la POO.</span></p><h2 class="h2_root__Y02lX"><span class="anchored_root__HWi6K"><span>Pourquoi¬†?</span> <small><a class="anchored_icon__N5Sem" id="pourquoi" title="Lien vers cette section" href="#pourquoi"><span>üîó</span></a></small></span></h2><p class="p_root__SHE_W"><span>Au del√† du fait que c&#x27;est un pattern r√©current et que √ßa adresse un probl√®me qui est commun (n&#x27;h√©sitez pas √† proposer lors des questions des applications qui n&#x27;auraient pas besoin de l&#x27;injection de d√©pendances).</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Testable</span> <small><a class="anchored_icon__N5Sem" id="testable" title="Lien vers cette section" href="#testable"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Parce que √ßa rend votre code testable, tout simplement. C&#x27;est beaucoup plus facile de le tester du code qui utilise l&#x27;injection de d√©pendances.</span></p><p class="p_root__SHE_W"><span>Je ne sais pas qui utilise mockery, pour mocker des modules, mais enfin c&#x27;est un peu l&#x27;horreur.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Configurable</span> <small><a class="anchored_icon__N5Sem" id="configurable" title="Lien vers cette section" href="#configurable"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>C&#x27;est aussi configurable car comme vous mettez les d√©pendances en param√®tre, finalement, vous mettez ce que vous voulez en param√®tre, il suffit que vous respectiez l&#x27;interface de vos services pour pouvoir les r√©utiliser avec d&#x27;autres services qui seraient conceptuellement la m√™me chose.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Manageable</span> <small><a class="anchored_icon__N5Sem" id="manageable" title="Lien vers cette section" href="#manageable"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>J&#x27;ai mis √ßa parce que on en parlait tout √† l&#x27;heure mais en fait le d√©veloppement principalement c&#x27;est de la charge mentale, de la charge mentale a accumuler. Il faut √™tre capable d&#x27;avoir en t√™te tous les effets de bords possibles que le code vous √™tes en train d&#x27;√©crire peut g√©n√©rer et le fait de raisonner justement de mani√®re isol√©e, √ßa aide √† comprendre plus de code puisqu&#x27;on a moins de charge mentale.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>R√©-utilisable</span> <small><a class="anchored_icon__N5Sem" id="re-utilisable" title="Lien vers cette section" href="#re-utilisable"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Car, de ce fait, vous pouvez facilement r√©utiliser des morceaux de code. C&#x27;est plus que la modularisation du code, c&#x27;est aussi, r√©utiliser l&#x27;initialisation et l&#x27;arr√™t de vos services dans toutes vos applications.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Optimal</span> <small><a class="anchored_icon__N5Sem" id="optimal" title="Lien vers cette section" href="#optimal"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Optimal parce que, en fait, le code que vous auriez √©crit pour initialiser vos services et pour les d√©s-initialiser que vous auriez fait √† la mano, ici vous avez la garantie que c&#x27;est optimal car vous utilisez une librairie qui adresse vraiment ce probl√®me et qui essaie de le r√©soudre de mani√®re optimale donc, a priori, vous avez le meilleur code qui soit pour pouvoir utiliser vos d√©penses.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Instrumentable</span> <small><a class="anchored_icon__N5Sem" id="instrumentable" title="Lien vers cette section" href="#instrumentable"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Instrumentable, parce que, du coup √ßa fait que votre code devient plus un ensemble sur lequel vous pouvez raisonner plut√¥t que juste du code imp√©ratif qui ferait les choses s√©quentiellement. Mais on va voir cela plus en d√©tail tout √† l&#x27;heure.</span></p><h2 class="h2_root__Y02lX"><span class="anchored_root__HWi6K"><span>Inconv√©nients</span> <small><a class="anchored_icon__N5Sem" id="inconvenients" title="Lien vers cette section" href="#inconvenients"><span>üîó</span></a></small></span></h2><p class="p_root__SHE_W"><span>Alors, est ce qu&#x27;il ya des inconv√©nients¬†? Oui il y en a.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>D√©bogage</span> <small><a class="anchored_icon__N5Sem" id="debogage" title="Lien vers cette section" href="#debogage"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>l&#x27;inconv√©nient c&#x27;est le d√©bogage parce qu&#x27;effectivement l&#x27;initialisation des services, si jamais √ßa marche pas, va falloir mettre les mains dans le cambouis. C&#x27;est plus simple de d√©boguer du code qu&#x27;on voit que du code qui fonctionne de mani√®re magique, entre guillemets.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Typage statique</span> <small><a class="anchored_icon__N5Sem" id="typage-statique" title="Lien vers cette section" href="#typage-statique"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Le typage statique, forc√©ment, comme tous les services sont initialis√©s de mani√®re dynamique, on perd un peu de l&#x27; avantage de la v√©rification du code typ√© par le compilateur.</span></p><h2 class="h2_root__Y02lX"><span class="anchored_root__HWi6K"><span>D√©monstration</span> <small><a class="anchored_icon__N5Sem" id="demonstration" title="Lien vers cette section" href="#demonstration"><span>üîó</span></a></small></span></h2><p class="p_root__SHE_W"><span>J&#x27;ai cr√©√© une petite application, plut√¥t, un outil en ligne de commande qui ne fait pas grand chose. Il y a trois ou quatre commandes. Une commande qui montre le temps Unix, une qui envoies un fichier dans un serveur FTP (on voit ici un service docker que j&#x27;ai lanc√©), il y a une commande qui ins√®re des donn√©es dans une base de donn√©es et, normalement, il y a une commande qui les affiches.</span></p><p class="p_root__SHE_W"><span>Voil√† c&#x27;est vraiment tout simple. Je l&#x27;ai fait en TypeScript car je voulais montrer quelque chose qui ne fonctionne que TypeScript mais √ßa peut fonctionner en JS normal.</span></p><p class="p_root__SHE_W"><span>Donc, qu&#x27;est ce qui se passe¬†? Par exemple, ici, j&#x27;ai ma commande qui ins√®re des des lignes dans la base de donn√©es. Alors j&#x27;initialise, je fais √ßa b√™tement, j&#x27;initialise la base de donn√©es, le serveur FTP (le serveur FTP, au d√©but je voulais aller chercher le fichier sur le serveur FTP mais j&#x27;ai pas eu le temps, donc je l&#x27;initialise pour rien, je crois). J&#x27;initialise aussi le syst√®me de journalisation et j&#x27;initialise le petit service qui va chercher les arguments.</span></p><p class="p_root__SHE_W"><span>Enfin, j&#x27;ai le code qui, finalement, est tout simple, j&#x27;ai m√™me directement supprim√© la base de donn√©es √† chaque fois que j&#x27;ins√®re des lignes parce que c&#x27;est vraiment que pour l&#x27;exemple. Ici, je prends chaque fichier que j&#x27;ai pass√© en argument et je lis leur contenu. Il y a un petit parseur CSV des familles et puis, ici, je mets chaque ligne une par une dans la base. J&#x27;ai pas pris le temps de s√©parer en sous-fonctions proprement mais j&#x27;esp√®re que vous ne m&#x27;en tiendrez pas rigueur.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Les probl√®mes</span> <small><a class="anchored_icon__N5Sem" id="les-problemes" title="Lien vers cette section" href="#les-problemes"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Du coup, les probl√®mes qui sont pos√©s de part par le fait de proc√©der comme √ßa¬†: on peut pas utiliser le serveur FTP et la base de donn√©es plusieurs fois parce que, tout simplement, la base de donn√©es, quand elle s&#x27;initialise (j&#x27;ai vraiment pas utilis√© l&#x27;injection de d√©pendances), en fait, ce qui se passe c&#x27;est qu&#x27;elle va aller chercher sa configuration et que la configuration, finalement, elle est fix√©e en dur.</span></p><p class="p_root__SHE_W"><span>C&#x27;est √† dire qu&#x27;elle va automatiquement aller chercher la configuration qui a √©t√© demand√©e ici dans ma configuration et, du coup, si j&#x27;ai besoin d&#x27;acc√©der √† deux bases de donn√©es diff√©rentes, je peux pas. Si je veux pouvoir instancier deux fois le service base de donn√©e avec deux serveurs diff√©rents, je suis bloqu√©.</span></p><p class="p_root__SHE_W"><span>Pareil pour les tests, mais on en a d√©j√† parl√©. Ce serait super chiant de tester ce code, il faudra utiliser mockery et tout r√©-impl√©menter from scratch mais avec des stubs. On peut pas remplacer le FTP par S3 facilement et, en plus, c&#x27;est un choix binaire. C&#x27;est √† dire que si demain je veux remplacer FTP par S3 seulement dans un environnement, je ne peux pas, je suis oblig√© d&#x27;utiliser S3 dans tous les environnements.</span></p><p class="p_root__SHE_W"><span>Si jamais j&#x27;ai un service qui demande un refacto ou si je change l&#x27;ordre d&#x27;initialisation des services, il va falloir que change le code un petit peu partout dans l&#x27;application. En fait, c&#x27;est assez compliqu√© d&#x27;agir sur une telle base de code.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Knifecycle</span> <small><a class="anchored_icon__N5Sem" id="knifecycle" title="Lien vers cette section" href="#knifecycle"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Du coup, je vais vous pr√©senter un petit module j&#x27;ai r√©alis√© et dont je me sers souvent. Je sais, √ßa fait genre, la personne qui vient pr√©senter son module mais √ßa m&#x27;aurait emb√™t√© d&#x27;illustrer l&#x27;injection de d√©pendance avec un autre module ;). Le module que j&#x27;utilise c&#x27;est Knifecycle.</span></p><p class="p_root__SHE_W"><span>Alors qu&#x27;est-ce que ca veut dire &quot;l&#x27;injection d√©pendance avec la banane mais sans le gorille et sans la jungle&quot;¬†? Je sais pas si vous connaissez la citation mais en gros, le petit lol sur la POO est que quand vous voulez une banane vous √™tes oblig√© de prendre le gorille et la jungle avec la la banane. Vous n&#x27;avez pas trop le choix.</span></p><p class="p_root__SHE_W"><span>Donc l√† l&#x27;id√©e c&#x27;est justement de ne pas ouvrir la bo√Æte de pandore avec la POO √† l inverse de ce qui se fait en fait beaucoup dans la plupart des frameworks qui utilisent l&#x27;injection de d√©pendances.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Refactoring</span> <small><a class="anchored_icon__N5Sem" id="refactoring" title="Lien vers cette section" href="#refactoring"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Donc du coup je vais faire un petit refacto. Il va √™tre tr√®s simple. Je vais reprendre chacun des services un par un et je vais les d√©clarer comme √©tant des initializer avec Knifecycle.</span></p><p class="p_root__SHE_W"><span>En fait, c&#x27;est relativement simple pour d√©clarer un initializer, j&#x27;ai juste √† faire appel aux fonctions utilitaires pr√©vues √† cet effet. Par exemple, le service args est est un simple service qui expose les arguments fournis en ligne de commande donc j&#x27;utilise la function service pour la d√©clarer. Je lui donne un nom et c&#x27;est tout car il n&#x27;a pas de d√©pendances. On fera peut-√™tre du d√©bogage, j&#x27;esp√®re que non, mais c&#x27;est le risque.</span></p><p class="p_root__SHE_W"><span>La configuration, c&#x27;est pareil, c&#x27;est un service qui va juste charger la configuration dans un fichier en fonction de l&#x27;environnement donc j&#x27;utilise aussi la fonction service. D&#x27;ailleurs, ici, je vais utiliser une petite astuce, la fonction </span><code class="code_root__5JLV_">autoName</code><span> qui va induire le nom du service du nom de la fonction. Quelqu&#x27;un dans la salle: C&#x27;est un peu magique¬†! Oui, il y a une partie de magie effectivement.</span></p><p class="p_root__SHE_W"><span>Ici pour la base de donn√©es, pareil, c&#x27;est un service. Ou plut√¥t, un provider, car non seulement, il fourni le service, mais il g√®re aussi le shutdown du service. C&#x27;est le seul moment o√π √ßa devient intrusif dans le code mais en m√™me temps √ßa apporte une fonctionnalit√© (un probl√®me de type avec TypeScript est arriv√© durant le refactoring live, le fix a √©t√© publi√© ensuite sur GitHub). Je vais renoncer, vous aurez pas la d√©mo avec provider sinon, √ßa va me prendre trop de temps</span></p><p class="p_root__SHE_W"><span>Pour le ftp, c&#x27;est pareil, c&#x27;est un service. Knifecycle propose tout un tas de fonctions utilitaires, mais ici, je vais r√©utiliser la fonction </span><code class="code_root__5JLV_">service</code><span>. D&#x27;ailleurs, je suis en train de faire l&#x27;impasse sur l&#x27;injection de d√©pendance, mais je vais y revenir apr√®s.</span></p><p class="p_root__SHE_W"><span>Ici, de m√™me, pour le logger, c&#x27;est un service, tout comme le timer. Vous avez pu voir que j&#x27;ai mis des interfaces, ce n&#x27;est pas innocent, c&#x27;est parce que je vais en avoir besoin apr√®s et puis je voulais pas que √ßa prenne trop de temps. Du coup, maintenant tous mes services sont bien configur√©s. Passons aux d√©pendances.</span></p><p class="p_root__SHE_W"><span>Le serveur FTP d√©pend de la configuration donc l√† ce que je vais faire c&#x27;est que je vais injecter la configuration dedans et je vais lui rajouter un type. Pourquoi je pr√©cise le type¬†? Parce que, justement, c&#x27;est l√† l&#x27;inconv√©nient dont je parlais tout √† l&#x27;heure. Le compilateur, ici, n&#x27;a aucune id√©e de ce que je vais mettre l√†-dedans. On est oblig√©s de d√©clarer une interface, c&#x27;est un inconv√©nient sans vraiment l&#x27;√™tre car finalement le fait que je lui dise, la config que je vais te passer va √™tre de ce type l√†, permet d&#x27;avoir une couche d&#x27;abstraction. C&#x27;est cette couche l√†, aussi, qui fait que je vais pouvoir avoir des interfaces identique pour des services diff√©rents et c&#x27;est aussi cette couche l√† qui va nous permettre de raisonner d&#x27;une mani√®re un petit peu plus intelligente que de juste dire, je veux r√©cup√©rer une librairie.</span></p><p class="p_root__SHE_W"><span>Par exemple, si comme nous vous utilisez S3, nous, en fait, on ne l&#x27;utilise pas directement, on a un service de stockage avec des m√©thodes get et put et on peut le substituer et par n&#x27;importe quoi. Demain, on d√©cide de plus passer par S3 mais le service concurrent d√©velopp√© par OVH, on peut. Simplement car on a raisonn√© en terme de briques fonctionnelles et non en terme de technologies.</span></p><p class="p_root__SHE_W"><span>M√™me op√©ration pour le service de DB. Normalement √ßa devrait vous rappeler un truc, pour ceux qui ont fait du AngularJS. C&#x27;est vraiment du copier/coll√© pour le coup, j&#x27;ai vraiment copi√© son usage.</span></p><p class="p_root__SHE_W"><span>Maintenant je vais regarder dans mes commandes, du coup, √ßa va √™tre le m√™me d√©lire. Mais Je vais utiliser la fonction </span><code class="code_root__5JLV_">autoService</code><span> qui inf√®re le nom du service et de ses d√©pendances automatiquement.</span></p><p class="p_root__SHE_W"><span>Une personne dans la salle: Comment tu d√©tecte ces valeurs¬†?</span></p><p class="p_root__SHE_W"><span>Sur la signature, en fait, tout simplement, √ßa fait un </span><code class="code_root__5JLV_">toString</code><span> sur la fonction avec une petite expression r√©guli√®re qui r√©cup√®re les bons arguments c&#x27;est ce que faisait AngularJS √† l&#x27;√©poque, j&#x27;ai vraiment pas innov√©.</span></p><p class="p_root__SHE_W"><span>Voir toutes les modifications sur le </span><a class="a_root__WEPS7" target="_blank" href="https://github.com/nfroidure/di-test"><span>d√©pot GitHub</span></a><span>.</span></p><h2 class="h2_root__Y02lX"><span class="anchored_root__HWi6K"><span>Aller plus loin</span> <small><a class="anchored_icon__N5Sem" id="aller-plus-loin" title="Lien vers cette section" href="#aller-plus-loin"><span>üîó</span></a></small></span></h2><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Le chargement automatique</span> <small><a class="anchored_icon__N5Sem" id="le-chargement-automatique" title="Lien vers cette section" href="#le-chargement-automatique"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Comme on l&#x27;a vu dans la d√©mo, il est possible de charger automatiquement les d√©pendances pour un peu plus de magie, je ne vais pas revenir dessus.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>G√©n√©ration de graphes</span> <small><a class="anchored_icon__N5Sem" id="generation-de-graphes" title="Lien vers cette section" href="#generation-de-graphes"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>On peut g√©n√©rer des graphes, ici par exemple, c&#x27;est mon petit module jsarch que j&#x27;utilise pour documenter l&#x27;architecture directement dans mes fichiers JS. Pour le cr√©er, j&#x27;ai utilis√© Knifecycle est gr√¢ce √† cela, j&#x27;ai pu g√©n√©rer un graphe qui r√©sume sa structure.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Le build statique</span> <small><a class="anchored_icon__N5Sem" id="le-build-statique" title="Lien vers cette section" href="#le-build-statique"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Knifecycle propose aussi de cr√©er un build statique. Cela √©vite d&#x27;embarquer la librairie dans vos projets, il suffit de g√©n√©rer un fichier qui cr√©e pour vous, statiquement, le fichier JS qui va bien pour initialiser vos services.</span></p><p class="p_root__SHE_W"><span>Chez nous, on utilise cela pour builder nos lambdas fonctions chez AWS. Cela permet d&#x27;avoir un build l√©ger car on embarque que ce dont on a besoin. Clairement il faut mettre les mains dans le cambouis mais c&#x27;√©tait pour montrer que c&#x27;est possible.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Cr√©er des serveurs HTTP</span> <small><a class="anchored_icon__N5Sem" id="creer-des-serveurs-http" title="Lien vers cette section" href="#creer-des-serveurs-http"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Nous on utilise Knifecycle principalement pour le back-end. Je vous laisse jeter un ≈ìil √† Whook, le module que nous utilisons conjointement √† Knifecycle.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Services commun</span> <small><a class="anchored_icon__N5Sem" id="services-commun" title="Lien vers cette section" href="#services-commun"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Voici une petite liste de services qu&#x27;on a open-sourc√© et qui peuvent √™tre utilis√©s cl√© en main avec Knifecycle.</span></p><h3 class="h3_root__kVaqq"><span class="anchored_root__HWi6K"><span>Cr√©√© avec Knifecycle</span> <small><a class="anchored_icon__N5Sem" id="cree-avec-knifecycle" title="Lien vers cette section" href="#cree-avec-knifecycle"><span>üîó</span></a></small></span></h3><p class="p_root__SHE_W"><span>Voici une petite liste de projets qui utilisent Knifecycle.</span></p><h2 class="h2_root__Y02lX"><span class="anchored_root__HWi6K"><span>Questions</span> <small><a class="anchored_icon__N5Sem" id="questions" title="Lien vers cette section" href="#questions"><span>üîó</span></a></small></span></h2><p class="p_root__SHE_W"><span>Voil√†, si vous avez des questions¬†:).</span></p><p class="p_root__SHE_W">Published at<!-- --> <!-- -->samedi 2 f√©vrier 2019 √† 08:00:00<!-- -->.</p></section><section class="contentBlock_root__802UK"><aside class="share_root__Qm_RR"><h2 class="h2_root__Y02lX">Commenter et partager</h2><p class="p_root__SHE_W"><a class="a_root__WEPS7" title="Commenter sur Facebook" target="_blank" href="https://www.facebook.com/dialog/share?display=popup&amp;href=https%3A%2F%2Finsertafter.com%2Fblog%2Finjection_de_dependance_nodejs&amp;redirect_uri=https%3A%2F%2Finsertafter.com"><span class="share_icon__bi4Q3 share_facebook__JKn8d"></span>Facebook</a> - <a class="a_root__WEPS7" title="Commenter sur Twitter" target="_blank" href="https://twitter.com/intent/tweet/?url=https%3A%2F%2Finsertafter.com%2Fblog%2Finjection_de_dependance_nodejs&amp;text=Injection%20de%20d%C3%A9pendances%20avec%20NodeJS%20&amp;via=nfroidure"><span class="share_icon__bi4Q3 "></span>Twitter</a> - <a class="a_root__WEPS7" title="Me r√©pondre par mail" target="_self" href="mailto:nicolas.froidure@gmail.com"><span class="share_icon__bi4Q3 share_mail__yvBDK"></span>Courriel</a></p></aside></section><section class="contentBlock_root__802UK"><aside class="page_linkedEntries__jiPuT"><h2 class="h2_root__Y02lX">Articles similaires</h2><p class="p_root__SHE_W">Dans les cat√©gories<!-- --> <!-- -->JavaScript, NodeJS et Injection de d√©pendances<!-- -->.</p><div class="items_entries__5hkLG"><div class="items_entry_item__GWeg7"><h2 class="h2_root__Y02lX items_entry_title__vJ_8h"><a class="a_root__WEPS7 items_entry_link__EtVod" title="Lire cet article de blog" target="_self" href=".//documentation_du_code">Documentation d&#x27;applications en JavaScript</a></h2><p class="p_root__SHE_W items_entry_description__ZWt9y">Documenter son code est parfois fastidieux. Pourtant, c&#x27;est une n√©cessit√©. Petit retour d&#x27;exp√©rience sur les techniques et outils que j&#x27;utilise.<!-- --> <br/><a class="a_root__WEPS7" title="Lire cet article de blog" target="_self" href=".//documentation_du_code">Lire la suite</a></p><p class="p_root__SHE_W items_entry_time__iNrot">Published at<!-- --> <!-- -->samedi 11 mars 2017 √† 19:02:27<!-- -->.</p><div class="items_clear__3fyGk"></div></div><div class="items_entry_item__GWeg7"><h2 class="h2_root__Y02lX items_entry_title__vJ_8h"><a class="a_root__WEPS7 items_entry_link__EtVod" title="Lire cet article de blog" target="_self" href=".//generation_api_cliente">G√©n√©ration automatique de clients d&#x27;APIs</a></h2><p class="p_root__SHE_W items_entry_description__ZWt9y">Personne de devrait perdre du temps √† √©crire du code qui peut √™tre g√©n√©r√© automatiquement. Voici comment je m&#x27;y prends pour les clients d&#x27;APIs.<!-- --> <br/><a class="a_root__WEPS7" title="Lire cet article de blog" target="_self" href=".//generation_api_cliente">Lire la suite</a></p><p class="p_root__SHE_W items_entry_time__iNrot">Published at<!-- --> <!-- -->dimanche 19 f√©vrier 2017 √† 16:00:00<!-- -->.</p><div class="items_clear__3fyGk"></div></div><div class="items_entry_item__GWeg7"><h2 class="h2_root__Y02lX items_entry_title__vJ_8h"><a class="a_root__WEPS7 items_entry_link__EtVod" title="Lire cet article de blog" target="_self" href=".//metapak">M√©ta-paquets NPM avec metapak</a></h2><p class="p_root__SHE_W items_entry_description__ZWt9y">Pr√©sentation sur metapak, un module d&#x27;aide √† la cr√©ation de m√©ta-paquets NPM.<!-- --> <br/><a class="a_root__WEPS7" title="Lire cet article de blog" target="_self" href=".//metapak">Lire la suite</a></p><p class="p_root__SHE_W items_entry_time__iNrot">Published at<!-- --> <!-- -->dimanche 5 f√©vrier 2017 √† 08:46:44<!-- -->.</p><div class="items_clear__3fyGk"></div></div></div></aside></section></div></main><aside class="social_iaSocial__kdR1x"><nav><ul><li><a href="https://mastodon.social/@nfroidure" rel="me" title="Me suivre sur Mastodon" class="social_iaSocialMastodon__MTF6o"><span>Mastodon</span></a></li><li><a href="https://bsky.app/profile/nfroidure.bsky.social" rel="me" title="Me suivre sur Bluesky" class="social_iaSocialBluesky__fKW6M"><span>Bluesky</span></a></li><li><a href="https://twitter.com/nfroidure" title="Me suivre sur Twitter" class="social_iaSocialTwitter__9nU6R"><span>Twitter</span></a></li><li><a href="https://github.com/nfroidure" title="Voir mes projets sur GitHub" class="social_iaSocialGithub__vcU5_"><span>GitHub</span></a></li><li><a href="https://www.npmjs.org/~nfroidure" title="Voir mon compte NPM" class="social_iaSocialNpm__6nku5"><span>NPM</span></a></li><li><a href="https://www.linkedin.com/in/nfroidure/" rel="me" title="Voir mon profil LinkedIn" class="social_iaSocialLinkedin__pWACO"><span>LinkedIn</span></a></li><li><a href="https://facebook.com/nicolas.froidure.douai" rel="me" title="Me suivre sur Facebook" class="social_iaSocialFacebook__w4wfH"><span>Facebook</span></a></li><li><a href="/fr/blog/index.atom" title="S‚Äôabonner au flux RSS" class="social_iaSocialFeed__gEQQ0"><span>Flux RSS</span></a></li></ul></nav></aside><footer class="footer_iaFooter__rhlnQ"><p class="footer_iaFooterContent__VZndF">¬© Nicolas Froidure 2012-<!-- -->2024</p></footer><script src="https://insertafter.com/_next/static/chunks/webpack-e22d0b50184c3e5b.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"0:\"$L1\"\n"])</script><script>self.__next_f.push([1,"2:HL[\"https://insertafter.com/_next/static/css/1f9f2e31c0c7b0ad.css\",\"style\",{\"crossOrigin\":\"\"}]\n3:HL[\"https://insertafter.com/_next/static/css/c0794213978ef12b.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"4:I[7690,[],\"\"]\n7:I[5613,[],\"\"]\na:I[1778,[],\"\"]\n11:I[8955,[],\"\"]\n8:[\"locale\",\"fr\",\"d\"]\n9:[\"id\",\"injection_de_dependance_nodejs\",\"d\"]\nc:{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"}\nd:{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHei"])</script><script>self.__next_f.push([1,"ght\":\"49px\"}\ne:{\"display\":\"inline-block\"}\nf:{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0}\n"])</script><script>self.__next_f.push([1,"1:[null,[\"$\",\"$L4\",null,{\"buildId\":\"9fUASsqhclwKyXSiuGa9K\",\"assetPrefix\":\"https://insertafter.com\",\"initialCanonicalUrl\":\"/fr/blog/injection_de_dependance_nodejs\",\"initialTree\":[\"\",{\"children\":[\"(withLocale)\",{\"children\":[[\"locale\",\"fr\",\"d\"],{\"children\":[\"blog\",{\"children\":[[\"id\",\"injection_de_dependance_nodejs\",\"d\"],{\"children\":[\"__PAGE__?{\\\"locale\\\":\\\"fr\\\",\\\"id\\\":\\\"injection_de_dependance_nodejs\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true]}]}],\"initialSeedData\":[\"\",{\"children\":[\"(withLocale)\",{\"children\":[[\"locale\",\"fr\",\"d\"],{\"children\":[\"blog\",{\"children\":[[\"id\",\"injection_de_dependance_nodejs\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L5\",\"$L6\",null]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(withLocale)\",\"children\",\"$8\",\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://insertafter.com/_next/static/css/c0794213978ef12b.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(withLocale)\",\"children\",\"$8\",\"children\",\"blog\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,\"$Lb\",null]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(withLocale)\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://insertafter.com/_next/static/css/1f9f2e31c0c7b0ad.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":\"$c\",\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":\"$d\",\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":\"$e\",\"children\":[\"$\",\"h2\",null,{\"style\":\"$f\",\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]],\"initialHead\":[false,\"$L10\"],\"globalErrorComponent\":\"$11\"}]]\n"])</script><script>self.__next_f.push([1,"12:\"$Sreact.strict_mode\"\n13:I[4630,[\"176\",\"static/chunks/176-0a03be62efe5672b.js\",\"960\",\"static/chunks/app/(withLocale)/%5Blocale%5D/layout-6f34dfcd57f7d3e4.js\"],\"\"]\n14:I[4341,[\"176\",\"static/chunks/176-0a03be62efe5672b.js\",\"960\",\"static/chunks/app/(withLocale)/%5Blocale%5D/layout-6f34dfcd57f7d3e4.js\"],\"\"]\n"])</script><script>self.__next_f.push([1,"b:[\"$\",\"$12\",null,{\"children\":[\"$\",\"html\",null,{\"lang\":\"fr\",\"children\":[\"$\",\"body\",null,{\"className\":\"layout_body__jFZuu\",\"children\":[null,[\"$\",\"header\",null,{\"className\":\"header_iaHeader__4vCMA\",\"children\":[\"$\",\"div\",null,{\"className\":\"$undefined\",\"children\":[\"$\",\"h1\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/fr\",\"title\":\"Retour √† l‚Äôaccueil\",\"className\":\"header_iaHeaderLogo__0uNr1\",\"children\":[\"$\",\"img\",null,{\"src\":\"/images/logo.svg\",\"alt\":\"Logo d‚ÄôInsertAfter\"}]}]}]}]}],[\"$\",\"$L13\",null,{\"locale\":\"fr\",\"dictionary\":{\"home\":{\"label\":\"Accueil\",\"title\":\"Retour √† l‚Äôaccueil\"},\"blog\":{\"label\":\"Blog\",\"title\":\"Retour √† l‚Äôindex du blog\"},\"projects\":{\"label\":\"Projets\",\"title\":\"D√©couvrir mes divers projets\"},\"about\":{\"label\":\"√Ä propos\",\"title\":\"En savoir plus √† mon sujet\"}}}],[\"$\",\"$L14\",null,{\"locale\":\"fr\"}],[\"$\",\"main\",null,{\"className\":\"layout_iaMain__6s2gl\",\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(withLocale)\",\"children\",\"$8\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$L15\",\"notFoundStyles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://insertafter.com/_next/static/css/719d59f1b635ba1d.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],\"styles\":null}]}]}],[\"$\",\"aside\",null,{\"className\":\"social_iaSocial__kdR1x\",\"children\":[\"$\",\"nav\",null,{\"children\":[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://mastodon.social/@nfroidure\",\"rel\":\"me\",\"title\":\"Me suivre sur Mastodon\",\"className\":\"social_iaSocialMastodon__MTF6o\",\"children\":[\"$\",\"span\",null,{\"children\":\"Mastodon\"}]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://bsky.app/profile/nfroidure.bsky.social\",\"rel\":\"me\",\"title\":\"Me suivre sur Bluesky\",\"className\":\"social_iaSocialBluesky__fKW6M\",\"children\":[\"$\",\"span\",null,{\"children\":\"Bluesky\"}]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://twitter.com/nfroidure\",\"title\":\"Me suivre sur Twitter\",\"className\":\"social_iaSocialTwitter__9nU6R\",\"children\":[\"$\",\"span\",null,{\"children\":\"Twitter\"}]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/nfroidure\",\"title\":\"Voir mes projets sur GitHub\",\"className\":\"social_iaSocialGithub__vcU5_\",\"children\":[\"$\",\"span\",null,{\"children\":\"GitHub\"}]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://www.npmjs.org/~nfroidure\",\"title\":\"Voir mon compte NPM\",\"className\":\"social_iaSocialNpm__6nku5\",\"children\":[\"$\",\"span\",null,{\"children\":\"NPM\"}]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://www.linkedin.com/in/nfroidure/\",\"rel\":\"me\",\"title\":\"Voir mon profil LinkedIn\",\"className\":\"social_iaSocialLinkedin__pWACO\",\"children\":[\"$\",\"span\",null,{\"children\":\"LinkedIn\"}]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://facebook.com/nicolas.froidure.douai\",\"rel\":\"me\",\"title\":\"Me suivre sur Facebook\",\"className\":\"social_iaSocialFacebook__w4wfH\",\"children\":[\"$\",\"span\",null,{\"children\":\"Facebook\"}]}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"/fr/blog/index.atom\",\"title\":\"S‚Äôabonner au flux RSS\",\"className\":\"social_iaSocialFeed__gEQQ0\",\"children\":[\"$\",\"span\",null,{\"children\":\"Flux RSS\"}]}]}]]}]}]}],[\"$\",\"footer\",null,{\"className\":\"footer_iaFooter__rhlnQ\",\"children\":[\"$\",\"p\",null,{\"className\":\"footer_iaFooterContent__VZndF\",\"children\":[\"¬© Nicolas Froidure 2012-\",2024]}]}]]}]}]}]\n"])</script><script>self.__next_f.push([1,"15:[\"$\",\"section\",null,{\"className\":\"contentBlock_root__802UK\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"h1_root__VPXQG\",\"children\":\"Page not found\"}],[\"$\",\"p\",null,{\"className\":\"not-found_p__fvcGn\",\"children\":[[\"$\",\"img\",null,{\"className\":\"not-found_img__IT2jY\",\"src\":\"https://media.giphy.com/media/12mPcp41D9a1i0/giphy.gif\",\"alt\":\"404.png\"}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":\"It seems that the page you look for doesn't exist.\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"16:I[5250,[\"176\",\"static/chunks/176-0a03be62efe5672b.js\",\"876\",\"static/chunks/876-4c07c683293830f5.js\",\"798\",\"static/chunks/app/(withLocale)/%5Blocale%5D/blog/%5Bid%5D/page-8c92e4ed1884a050.js\"],\"\"]\n"])</script><script>self.__next_f.push([1,"6:[[\"$\",\"section\",null,{\"className\":\"contentBlock_root__802UK\",\"children\":[[[\"$\",\"h1\",null,{\"className\":\"h1_root__VPXQG\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Injection de d√©pendances sans gorille\"}]]}],[\"$\",\"div\",\"1\",{\"children\":[\"$\",\"span\",null,{\"className\":\"img_root__vTZoG img_landscape__qBqfT\",\"children\":[[\"$\",\"span\",null,{\"className\":\"img_picture__pfsl0\",\"children\":[\"$\",\"img\",null,{\"alt\":\"Knifecycle logo\",\"src\":\"https://raw.githubusercontent.com/nfroidure/knifecycle/main/knifecycle.svg\"}]}],null]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"markdown_root__U7zrI\",\"children\":[\"$\",\"iframe\",null,{\"width\":\"560\",\"height\":\"315\",\"src\":\"https://www.youtube.com/embed/qTtwn1J9IXk\",\"title\":\"\",\"allow\":\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\",\"allowFullScreen\":true}]}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Retranscription de ma pr√©sentation au dernier ChtiJS sur l'injection de d√©pendances avec NodeJS mais plus g√©n√©ralement en JavaScript¬†!\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"div\",null,{\"className\":\"slidesDotCom_root__yd21N\",\"children\":[[\"$\",\"iframe\",null,{\"src\":\"https://slides.com/nfroidure/javascript_dependency_injection/embed\",\"allowFullScreen\":true}],[\"$\",\"noscript\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"https://slides.com/nfroidure/javascript_dependency_injection\",\"className\":\"a_root__WEPS7\",\"title\":\"Voir les diapositives de la pr√©sentation\",\"target\":\"_blank\",\"children\":[null,[[\"$\",\"span\",\"0\",{\"children\":\"Slides\"}]]]}]}]]}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Aujourd'hui, je vais vous parlais d'injection de d√©pendances en JavaScript. J'ai fait les slides en anglais car je vais les mettre sur mon blog apr√®s mais n'h√©sitez pas √† me demander de traduire si vous en ressentez le besoin.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"J'ai pr√©cis√© unobtrusive car l'objectif est que cette derni√®re n'interf√®re pas avec votre code. L'id√©e c'est d'avoir un minimum de code qui qui g√®re √ßa puisque finalement vous allez voir que ce n'est pas n√©cessaire.\"}]]}],[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"A propos de moi\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#a-propos-de-moi\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"a-propos-de-moi\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Faisons d'abord les pr√©sentations, je travaille pour Sencrop, vous l'avez vu tout √† l'heure. Je fais du logiciel pour les startups depuis que JavaScript est un sujet br√ªlant. Et une fois j'ai fait un code qui a failli compiler avec Rust. Vous pouvez me retrouver sur mon blog ou via Twitter.\"}]]}],[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Sencrop recrute\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#sencrop-recrute\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"sencrop-recrute\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Vous avez peut-√™tre entendu parler de la lev√©e de fond r√©cente de Sencrop. Du coup, on va pouvoir augmenter nos ambitions et pour ce faire on recrute des d√©veloppeurs back-end, front-end (mais si vous √™tes full-stack c'est bien aussi, des data scientists et des ing√©nieurs pour le d√©veloppement embarqu√© car on a une probl√©matique hardware √©galement.\"}]]}],[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"D√©finition\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#definition\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"definition\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Qui conna√Æt l'injection de d√©pendances¬†? Une bonne partie de la salle l√®ve la main. Qui l'utilise au quotidien¬†? Quelques mains se l√®vent. Une personne: \\\"C'est un peu la m√™me chose que Spring Boot en Java¬†?\\\" Alors, oui, c'est design pattern donc tu l'impl√©mentes comme tu veux, tu peux l'impl√©menter en POO ou pas.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"L'id√©e, en gros, de l'injection de d√©pendance, c'est que votre code a besoin de faire appel √† des √©tats externes, donc typiquement √ßa va √™tre les IOs (lire un fichier, enregistrer dans une base de donn√©es, faire un appel √† un service REST, peu importe...).On va donc chercher √† exprimer ces d√©pendances de mani√®re d√©clarative pour que le code m√©tier ne soit pas impact√© par toute la tuyauterie.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Finalement, on cherche que l'impl√©mentation soit compl√®tement d√©coupl√©e des d√©pendances et de leur initialisation.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"En JavaScript\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#en-javascript\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"en-javascript\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Donc, en JS, qu'est ce que √ßa peut donner¬†? En fait c'est tr√®s simple, si vous √™tes un fan de la POO, vous avez une classe et cette classe finalement vous allez lui injecter les services dont elle a besoin de mani√®re √† ce qu'en son sein, vous puissiez utiliser ces services sans vous soucier de leurs initialisation.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Avec les fonctions, c'est un peu plus simple, vous allez utiliser le passage d'arguments √† vos fonctions et vous allez utiliser, tout b√™tement, les services que vous avez pass√© en argument de vos fonctions.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"C'est assez simple, en fait, c'est un mot compliqu√© pour nommer quelque chose de tr√®s simple.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Cycle de vie d'une application\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#cycle-de-vie-d-une-application\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"cycle-de-vie-d-une-application\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Pourquoi c'est utile¬†? (Toute la salle penche la t√™te pour lire les annotations du sch√©ma projet√©). Oui, je vous vois tourner la t√™te, mais j'avais pas de place pour mettre les √©criteaux horizontalement.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Je vous mets au d√©fi de trouver une application qui n'a pas une phase de d√©marrage et une phase d'arr√™t, √† part le front-end, encore que, parfois, vous pouvez vouloir qu'il y ait des comportements au sortir de la page qui soient d√©clench√©s.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Du coup c'est un truc qui est super r√©current et c'est ce que l'injection d√©pendance adresse. C'est donc tr√®s commun de l'utiliser.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Les phases de l'injection de d√©pendances\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#les-phases-de-l-injection-de-dependances\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"les-phases-de-l-injection-de-dependances\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Alors, √† quoi √ßa ressemble finalement. Vous avez toutes vos d√©pendances (la fl√®che, ici, elle veut dire \\\"d√©pend de\\\", donc ce rond l√† d√©pend de cet autre l√†). Chaque n≈ìud est donc un service et les feuilles c'est le code m√©tier, celui qui exploite vos services.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Les d√©penses de votre application, c'est un graphe orient√© et l'id√©e, en fait, c'est finalement qu'on peut les initialiser d'une mani√®re optimale. C'est pas compliqu√©, vous commencez par instancier les services qui n'ont pas de d√©pendance, puis les services qui d√©pendent des services que vous avez initialis√©s √† la premi√®re it√©ration lors de la seconde it√©ration et √† la troisi√®me it√©ration les services qui vous n'avez pu cr√©er √† la seconde, etc jusqu'√† ce que toute votre application soit initialis√©e.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Pour l'extinction, c'est pareil sauf que l√† vos services, ils sont tous up et vous allez les stopper de mani√®re invers√©e afin que tous les services soient proprement arr√™t√©s. C'est le \\\"graceful shutdown\\\" pour ceux qui ne connaissent pas. C'est un probl√©matique plut√¥t back-end mais pourquoi pas en front.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Opinion\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#opinion\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"opinion\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"L'opinion que j'ai essayer de d√©velopper ce soir est que c'est le seul design pattern que vous ne regretterez jamais d'avoir impl√©menter. Pourquoi¬†? Parce que comme je l'ai annonc√© tout √† l'heure, c'est r√©current, c'est √† dire que √ßa adresse un probl√®me qui existe dans toutes les applications et donc c'est dommage de ne pas l'utiliser surtout quand on le conna√Æt.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"La deuxi√®me opinion que je vais essayer de d√©velopper est que si vous utilisez de la programmation orient√©e objet ne bl√¢mez pas l'injection de d√©pendances parce que c'est pas de sa faute si vous avez l'impression que c'est n'importe quoi, mais celle de la POO.\"}]]}],[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Pourquoi¬†?\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#pourquoi\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"pourquoi\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Au del√† du fait que c'est un pattern r√©current et que √ßa adresse un probl√®me qui est commun (n'h√©sitez pas √† proposer lors des questions des applications qui n'auraient pas besoin de l'injection de d√©pendances).\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Testable\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#testable\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"testable\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Parce que √ßa rend votre code testable, tout simplement. C'est beaucoup plus facile de le tester du code qui utilise l'injection de d√©pendances.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Je ne sais pas qui utilise mockery, pour mocker des modules, mais enfin c'est un peu l'horreur.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Configurable\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#configurable\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"configurable\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"C'est aussi configurable car comme vous mettez les d√©pendances en param√®tre, finalement, vous mettez ce que vous voulez en param√®tre, il suffit que vous respectiez l'interface de vos services pour pouvoir les r√©utiliser avec d'autres services qui seraient conceptuellement la m√™me chose.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Manageable\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#manageable\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"manageable\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"J'ai mis √ßa parce que on en parlait tout √† l'heure mais en fait le d√©veloppement principalement c'est de la charge mentale, de la charge mentale a accumuler. Il faut √™tre capable d'avoir en t√™te tous les effets de bords possibles que le code vous √™tes en train d'√©crire peut g√©n√©rer et le fait de raisonner justement de mani√®re isol√©e, √ßa aide √† comprendre plus de code puisqu'on a moins de charge mentale.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"R√©-utilisable\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#re-utilisable\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"re-utilisable\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Car, de ce fait, vous pouvez facilement r√©utiliser des morceaux de code. C'est plus que la modularisation du code, c'est aussi, r√©utiliser l'initialisation et l'arr√™t de vos services dans toutes vos applications.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Optimal\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#optimal\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"optimal\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Optimal parce que, en fait, le code que vous auriez √©crit pour initialiser vos services et pour les d√©s-initialiser que vous auriez fait √† la mano, ici vous avez la garantie que c'est optimal car vous utilisez une librairie qui adresse vraiment ce probl√®me et qui essaie de le r√©soudre de mani√®re optimale donc, a priori, vous avez le meilleur code qui soit pour pouvoir utiliser vos d√©penses.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Instrumentable\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#instrumentable\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"instrumentable\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Instrumentable, parce que, du coup √ßa fait que votre code devient plus un ensemble sur lequel vous pouvez raisonner plut√¥t que juste du code imp√©ratif qui ferait les choses s√©quentiellement. Mais on va voir cela plus en d√©tail tout √† l'heure.\"}]]}],[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Inconv√©nients\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#inconvenients\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"inconvenients\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Alors, est ce qu'il ya des inconv√©nients¬†? Oui il y en a.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"D√©bogage\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#debogage\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"debogage\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"l'inconv√©nient c'est le d√©bogage parce qu'effectivement l'initialisation des services, si jamais √ßa marche pas, va falloir mettre les mains dans le cambouis. C'est plus simple de d√©boguer du code qu'on voit que du code qui fonctionne de mani√®re magique, entre guillemets.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Typage statique\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#typage-statique\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"typage-statique\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Le typage statique, forc√©ment, comme tous les services sont initialis√©s de mani√®re dynamique, on perd un peu de l' avantage de la v√©rification du code typ√© par le compilateur.\"}]]}],[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"D√©monstration\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#demonstration\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"demonstration\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"J'ai cr√©√© une petite application, plut√¥t, un outil en ligne de commande qui ne fait pas grand chose. Il y a trois ou quatre commandes. Une commande qui montre le temps Unix, une qui envoies un fichier dans un serveur FTP (on voit ici un service docker que j'ai lanc√©), il y a une commande qui ins√®re des donn√©es dans une base de donn√©es et, normalement, il y a une commande qui les affiches.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Voil√† c'est vraiment tout simple. Je l'ai fait en TypeScript car je voulais montrer quelque chose qui ne fonctionne que TypeScript mais √ßa peut fonctionner en JS normal.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Donc, qu'est ce qui se passe¬†? Par exemple, ici, j'ai ma commande qui ins√®re des des lignes dans la base de donn√©es. Alors j'initialise, je fais √ßa b√™tement, j'initialise la base de donn√©es, le serveur FTP (le serveur FTP, au d√©but je voulais aller chercher le fichier sur le serveur FTP mais j'ai pas eu le temps, donc je l'initialise pour rien, je crois). J'initialise aussi le syst√®me de journalisation et j'initialise le petit service qui va chercher les arguments.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Enfin, j'ai le code qui, finalement, est tout simple, j'ai m√™me directement supprim√© la base de donn√©es √† chaque fois que j'ins√®re des lignes parce que c'est vraiment que pour l'exemple. Ici, je prends chaque fichier que j'ai pass√© en argument et je lis leur contenu. Il y a un petit parseur CSV des familles et puis, ici, je mets chaque ligne une par une dans la base. J'ai pas pris le temps de s√©parer en sous-fonctions proprement mais j'esp√®re que vous ne m'en tiendrez pas rigueur.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Les probl√®mes\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#les-problemes\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"les-problemes\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Du coup, les probl√®mes qui sont pos√©s de part par le fait de proc√©der comme √ßa¬†: on peut pas utiliser le serveur FTP et la base de donn√©es plusieurs fois parce que, tout simplement, la base de donn√©es, quand elle s'initialise (j'ai vraiment pas utilis√© l'injection de d√©pendances), en fait, ce qui se passe c'est qu'elle va aller chercher sa configuration et que la configuration, finalement, elle est fix√©e en dur.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"C'est √† dire qu'elle va automatiquement aller chercher la configuration qui a √©t√© demand√©e ici dans ma configuration et, du coup, si j'ai besoin d'acc√©der √† deux bases de donn√©es diff√©rentes, je peux pas. Si je veux pouvoir instancier deux fois le service base de donn√©e avec deux serveurs diff√©rents, je suis bloqu√©.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Pareil pour les tests, mais on en a d√©j√† parl√©. Ce serait super chiant de tester ce code, il faudra utiliser mockery et tout r√©-impl√©menter from scratch mais avec des stubs. On peut pas remplacer le FTP par S3 facilement et, en plus, c'est un choix binaire. C'est √† dire que si demain je veux remplacer FTP par S3 seulement dans un environnement, je ne peux pas, je suis oblig√© d'utiliser S3 dans tous les environnements.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Si jamais j'ai un service qui demande un refacto ou si je change l'ordre d'initialisation des services, il va falloir que change le code un petit peu partout dans l'application. En fait, c'est assez compliqu√© d'agir sur une telle base de code.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Knifecycle\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#knifecycle\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"knifecycle\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Du coup, je vais vous pr√©senter un petit module j'ai r√©alis√© et dont je me sers souvent. Je sais, √ßa fait genre, la personne qui vient pr√©senter son module mais √ßa m'aurait emb√™t√© d'illustrer l'injection de d√©pendance avec un autre module ;). Le module que j'utilise c'est Knifecycle.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Alors qu'est-ce que ca veut dire \\\"l'injection d√©pendance avec la banane mais sans le gorille et sans la jungle\\\"¬†? Je sais pas si vous connaissez la citation mais en gros, le petit lol sur la POO est que quand vous voulez une banane vous √™tes oblig√© de prendre le gorille et la jungle avec la la banane. Vous n'avez pas trop le choix.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Donc l√† l'id√©e c'est justement de ne pas ouvrir la bo√Æte de pandore avec la POO √† l inverse de ce qui se fait en fait beaucoup dans la plupart des frameworks qui utilisent l'injection de d√©pendances.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Refactoring\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#refactoring\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"refactoring\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Donc du coup je vais faire un petit refacto. Il va √™tre tr√®s simple. Je vais reprendre chacun des services un par un et je vais les d√©clarer comme √©tant des initializer avec Knifecycle.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"En fait, c'est relativement simple pour d√©clarer un initializer, j'ai juste √† faire appel aux fonctions utilitaires pr√©vues √† cet effet. Par exemple, le service args est est un simple service qui expose les arguments fournis en ligne de commande donc j'utilise la function service pour la d√©clarer. Je lui donne un nom et c'est tout car il n'a pas de d√©pendances. On fera peut-√™tre du d√©bogage, j'esp√®re que non, mais c'est le risque.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"La configuration, c'est pareil, c'est un service qui va juste charger la configuration dans un fichier en fonction de l'environnement donc j'utilise aussi la fonction service. D'ailleurs, ici, je vais utiliser une petite astuce, la fonction \"}],[\"$\",\"code\",null,{\"className\":\"code_root__5JLV_\",\"children\":\"autoName\"}],[\"$\",\"span\",\"2\",{\"children\":\" qui va induire le nom du service du nom de la fonction. Quelqu'un dans la salle: C'est un peu magique¬†! Oui, il y a une partie de magie effectivement.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Ici pour la base de donn√©es, pareil, c'est un service. Ou plut√¥t, un provider, car non seulement, il fourni le service, mais il g√®re aussi le shutdown du service. C'est le seul moment o√π √ßa devient intrusif dans le code mais en m√™me temps √ßa apporte une fonctionnalit√© (un probl√®me de type avec TypeScript est arriv√© durant le refactoring live, le fix a √©t√© publi√© ensuite sur GitHub). Je vais renoncer, vous aurez pas la d√©mo avec provider sinon, √ßa va me prendre trop de temps\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Pour le ftp, c'est pareil, c'est un service. Knifecycle propose tout un tas de fonctions utilitaires, mais ici, je vais r√©utiliser la fonction \"}],[\"$\",\"code\",null,{\"className\":\"code_root__5JLV_\",\"children\":\"service\"}],[\"$\",\"span\",\"2\",{\"children\":\". D'ailleurs, je suis en train de faire l'impasse sur l'injection de d√©pendance, mais je vais y revenir apr√®s.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Ici, de m√™me, pour le logger, c'est un service, tout comme le timer. Vous avez pu voir que j'ai mis des interfaces, ce n'est pas innocent, c'est parce que je vais en avoir besoin apr√®s et puis je voulais pas que √ßa prenne trop de temps. Du coup, maintenant tous mes services sont bien configur√©s. Passons aux d√©pendances.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Le serveur FTP d√©pend de la configuration donc l√† ce que je vais faire c'est que je vais injecter la configuration dedans et je vais lui rajouter un type. Pourquoi je pr√©cise le type¬†? Parce que, justement, c'est l√† l'inconv√©nient dont je parlais tout √† l'heure. Le compilateur, ici, n'a aucune id√©e de ce que je vais mettre l√†-dedans. On est oblig√©s de d√©clarer une interface, c'est un inconv√©nient sans vraiment l'√™tre car finalement le fait que je lui dise, la config que je vais te passer va √™tre de ce type l√†, permet d'avoir une couche d'abstraction. C'est cette couche l√†, aussi, qui fait que je vais pouvoir avoir des interfaces identique pour des services diff√©rents et c'est aussi cette couche l√† qui va nous permettre de raisonner d'une mani√®re un petit peu plus intelligente que de juste dire, je veux r√©cup√©rer une librairie.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Par exemple, si comme nous vous utilisez S3, nous, en fait, on ne l'utilise pas directement, on a un service de stockage avec des m√©thodes get et put et on peut le substituer et par n'importe quoi. Demain, on d√©cide de plus passer par S3 mais le service concurrent d√©velopp√© par OVH, on peut. Simplement car on a raisonn√© en terme de briques fonctionnelles et non en terme de technologies.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"M√™me op√©ration pour le service de DB. Normalement √ßa devrait vous rappeler un truc, pour ceux qui ont fait du AngularJS. C'est vraiment du copier/coll√© pour le coup, j'ai vraiment copi√© son usage.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Maintenant je vais regarder dans mes commandes, du coup, √ßa va √™tre le m√™me d√©lire. Mais Je vais utiliser la fonction \"}],[\"$\",\"code\",null,{\"className\":\"code_root__5JLV_\",\"children\":\"autoService\"}],[\"$\",\"span\",\"2\",{\"children\":\" qui inf√®re le nom du service et de ses d√©pendances automatiquement.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Une personne dans la salle: Comment tu d√©tecte ces valeurs¬†?\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Sur la signature, en fait, tout simplement, √ßa fait un \"}],[\"$\",\"code\",null,{\"className\":\"code_root__5JLV_\",\"children\":\"toString\"}],[\"$\",\"span\",\"2\",{\"children\":\" sur la fonction avec une petite expression r√©guli√®re qui r√©cup√®re les bons arguments c'est ce que faisait AngularJS √† l'√©poque, j'ai vraiment pas innov√©.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Voir toutes les modifications sur le \"}],[\"$\",\"$L16\",null,{\"href\":\"https://github.com/nfroidure/di-test\",\"className\":\"a_root__WEPS7\",\"title\":null,\"target\":\"_blank\",\"children\":[null,[[\"$\",\"span\",\"0\",{\"children\":\"d√©pot GitHub\"}]]]}],[\"$\",\"span\",\"2\",{\"children\":\".\"}]]}],[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Aller plus loin\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#aller-plus-loin\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"aller-plus-loin\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Le chargement automatique\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#le-chargement-automatique\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"le-chargement-automatique\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Comme on l'a vu dans la d√©mo, il est possible de charger automatiquement les d√©pendances pour un peu plus de magie, je ne vais pas revenir dessus.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"G√©n√©ration de graphes\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#generation-de-graphes\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"generation-de-graphes\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"On peut g√©n√©rer des graphes, ici par exemple, c'est mon petit module jsarch que j'utilise pour documenter l'architecture directement dans mes fichiers JS. Pour le cr√©er, j'ai utilis√© Knifecycle est gr√¢ce √† cela, j'ai pu g√©n√©rer un graphe qui r√©sume sa structure.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Le build statique\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#le-build-statique\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"le-build-statique\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Knifecycle propose aussi de cr√©er un build statique. Cela √©vite d'embarquer la librairie dans vos projets, il suffit de g√©n√©rer un fichier qui cr√©e pour vous, statiquement, le fichier JS qui va bien pour initialiser vos services.\"}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Chez nous, on utilise cela pour builder nos lambdas fonctions chez AWS. Cela permet d'avoir un build l√©ger car on embarque que ce dont on a besoin. Clairement il faut mettre les mains dans le cambouis mais c'√©tait pour montrer que c'est possible.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Cr√©er des serveurs HTTP\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#creer-des-serveurs-http\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"creer-des-serveurs-http\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Nous on utilise Knifecycle principalement pour le back-end. Je vous laisse jeter un ≈ìil √† Whook, le module que nous utilisons conjointement √† Knifecycle.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Services commun\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#services-commun\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"services-commun\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Voici une petite liste de services qu'on a open-sourc√© et qui peuvent √™tre utilis√©s cl√© en main avec Knifecycle.\"}]]}],[\"$\",\"h3\",null,{\"className\":\"h3_root__kVaqq\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Cr√©√© avec Knifecycle\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#cree-avec-knifecycle\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"cree-avec-knifecycle\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Voici une petite liste de projets qui utilisent Knifecycle.\"}]]}],[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX\",\"children\":[\"$\",\"span\",null,{\"className\":\"anchored_root__HWi6K\",\"children\":[[[\"$\",\"span\",\"0\",{\"children\":\"Questions\"}]],\" \",[\"$\",\"small\",null,{\"children\":[\"$\",\"$L16\",null,{\"href\":\"#questions\",\"className\":\"anchored_icon__N5Sem\",\"id\":\"questions\",\"title\":\"Lien vers cette section\",\"children\":[\"$\",\"span\",null,{\"children\":\"üîó\"}]}]}]]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"span\",\"0\",{\"children\":\"Voil√†, si vous avez des questions¬†:).\"}]]}]],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[\"Published at\",\" \",\"samedi 2 f√©vrier 2019 √† 08:00:00\",\".\"]}]]}],[\"$\",\"section\",null,{\"className\":\"contentBlock_root__802UK\",\"children\":[\"$\",\"aside\",null,{\"className\":\"share_root__Qm_RR\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX\",\"children\":\"Commenter et partager\"}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[[\"$\",\"$L16\",null,{\"href\":\"https://www.facebook.com/dialog/share?display=popup\u0026href=https%3A%2F%2Finsertafter.com%2Fblog%2Finjection_de_dependance_nodejs\u0026redirect_uri=https%3A%2F%2Finsertafter.com\",\"className\":\"a_root__WEPS7\",\"title\":\"Commenter sur Facebook\",\"target\":\"_blank\",\"children\":[null,[[\"$\",\"span\",null,{\"className\":\"share_icon__bi4Q3 share_facebook__JKn8d\"}],\"Facebook\"]]}],\" - \",[\"$\",\"$L16\",null,{\"href\":\"https://twitter.com/intent/tweet/?url=https%3A%2F%2Finsertafter.com%2Fblog%2Finjection_de_dependance_nodejs\u0026text=Injection%20de%20d%C3%A9pendances%20avec%20NodeJS%20\u0026via=nfroidure\",\"className\":\"a_root__WEPS7\",\"title\":\"Commenter sur Twitter\",\"target\":\"_blank\",\"children\":[null,[[\"$\",\"span\",null,{\"className\":\"share_icon__bi4Q3 \"}],\"Twitter\"]]}],\" - \",[\"$\",\"$L16\",null,{\"href\":\"mailto:nicolas.froidure@gmail.com\",\"className\":\"a_root__WEPS7\",\"title\":\"Me r√©pondre par mail\",\"target\":\"_self\",\"children\":[null,[[\"$\",\"span\",null,{\"className\":\"share_icon__bi4Q3 share_mail__yvBDK\"}],\"Courriel\"]]}]]}]]}]}],[\"$\",\"section\",null,{\"className\":\"contentBlock_root__802UK\",\"children\":[\"$\",\"aside\",null,{\"className\":\"page_linkedEntries__jiPuT\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX\",\"children\":\"Articles similaires\"}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W\",\"children\":[\"Dans les cat√©gories\",\" \",\"JavaScript, NodeJS et Injection de d√©pendances\",\".\"]}],[\"$\",\"div\",null,{\"className\":\"items_entries__5hkLG\",\"children\":[[\"$\",\"div\",\"documentation_du_code\",{\"className\":\"items_entry_item__GWeg7\",\"children\":[null,[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX items_entry_title__vJ_8h\",\"children\":[\"$\",\"$L16\",null,{\"href\":\".//documentation_du_code\",\"className\":\"a_root__WEPS7 items_entry_link__EtVod\",\"title\":\"Lire cet article de blog\",\"target\":\"_self\",\"children\":[null,\"Documentation d'applications en JavaScript\"]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W items_entry_description__ZWt9y\",\"children\":[\"Documenter son code est parfois fastidieux. Pourtant, c'est une n√©cessit√©. Petit retour d'exp√©rience sur les techniques et outils que j'utilise.\",\" \",[\"$\",\"br\",null,{}],[\"$\",\"$L16\",null,{\"href\":\".//documentation_du_code\",\"className\":\"a_root__WEPS7\",\"title\":\"Lire cet article de blog\",\"target\":\"_self\",\"children\":[null,\"Lire la suite\"]}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W items_entry_time__iNrot\",\"children\":[\"Published at\",\" \",\"samedi 11 mars 2017 √† 19:02:27\",\".\"]}],[\"$\",\"div\",null,{\"className\":\"items_clear__3fyGk\"}]]}],[\"$\",\"div\",\"generation_api_cliente\",{\"className\":\"items_entry_item__GWeg7\",\"children\":[null,[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX items_entry_title__vJ_8h\",\"children\":[\"$\",\"$L16\",null,{\"href\":\".//generation_api_cliente\",\"className\":\"a_root__WEPS7 items_entry_link__EtVod\",\"title\":\"Lire cet article de blog\",\"target\":\"_self\",\"children\":[null,\"G√©n√©ration automatique de clients d'APIs\"]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W items_entry_description__ZWt9y\",\"children\":[\"Personne de devrait perdre du temps √† √©crire du code qui peut √™tre g√©n√©r√© automatiquement. Voici comment je m'y prends pour les clients d'APIs.\",\" \",[\"$\",\"br\",null,{}],[\"$\",\"$L16\",null,{\"href\":\".//generation_api_cliente\",\"className\":\"a_root__WEPS7\",\"title\":\"Lire cet article de blog\",\"target\":\"_self\",\"children\":[null,\"Lire la suite\"]}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W items_entry_time__iNrot\",\"children\":[\"Published at\",\" \",\"dimanche 19 f√©vrier 2017 √† 16:00:00\",\".\"]}],[\"$\",\"div\",null,{\"className\":\"items_clear__3fyGk\"}]]}],[\"$\",\"div\",\"metapak\",{\"className\":\"items_entry_item__GWeg7\",\"children\":[null,[\"$\",\"h2\",null,{\"className\":\"h2_root__Y02lX items_entry_title__vJ_8h\",\"children\":[\"$\",\"$L16\",null,{\"href\":\".//metapak\",\"className\":\"a_root__WEPS7 items_entry_link__EtVod\",\"title\":\"Lire cet article de blog\",\"target\":\"_self\",\"children\":[null,\"M√©ta-paquets NPM avec metapak\"]}]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W items_entry_description__ZWt9y\",\"children\":[\"Pr√©sentation sur metapak, un module d'aide √† la cr√©ation de m√©ta-paquets NPM.\",\" \",[\"$\",\"br\",null,{}],[\"$\",\"$L16\",null,{\"href\":\".//metapak\",\"className\":\"a_root__WEPS7\",\"title\":\"Lire cet article de blog\",\"target\":\"_self\",\"children\":[null,\"Lire la suite\"]}]]}],[\"$\",\"p\",null,{\"className\":\"p_root__SHE_W items_entry_time__iNrot\",\"children\":[\"Published at\",\" \",\"dimanche 5 f√©vrier 2017 √† 08:46:44\",\".\"]}],[\"$\",\"div\",null,{\"className\":\"items_clear__3fyGk\"}]]}]]}]]}]}]]\n"])</script><script>self.__next_f.push([1,"10:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"name\":\"theme-color\",\"content\":\"#3e78b2\"}],[\"$\",\"meta\",\"2\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"3\",{\"children\":\"Injection de d√©pendances avec NodeJS  - Nicolas Froidure\"}],[\"$\",\"meta\",\"4\",{\"name\":\"description\",\"content\":\"Pr√©sentation donn√©e lors du ChtiJS 21 √† propos de l'injection de d√©pendances en JavaScript.\"}],[\"$\",\"link\",\"5\",{\"rel\":\"author\",\"href\":\"https://insertafter.com\"}],[\"$\",\"meta\",\"6\",{\"name\":\"author\",\"content\":\"Nicolas Froidure\"}],[\"$\",\"meta\",\"7\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"link\",\"8\",{\"rel\":\"canonical\",\"href\":\"https://insertafter.com/fr/blog/injection_de_dependance_nodejs\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:title\",\"content\":\"Injection de d√©pendances avec NodeJS  - Nicolas Froidure\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:description\",\"content\":\"Pr√©sentation donn√©e lors du ChtiJS 21 √† propos de l'injection de d√©pendances en JavaScript.\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:url\",\"content\":\"https://insertafter.com/fr/blog/injection_de_dependance_nodejs\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:site_name\",\"content\":\"Nicolas Froidure\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:locale\",\"content\":\"fr_FR\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:image:alt\",\"content\":\"Banni√®re du site\"}],[\"$\",\"meta\",\"15\",{\"property\":\"og:image\",\"content\":\"https://insertafter.com/images/banner.png\"}],[\"$\",\"meta\",\"16\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:site\",\"content\":\"@nfroidure\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:creator\",\"content\":\"@nfroidure\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:title\",\"content\":\"Injection de d√©pendances avec NodeJS  - Nicolas Froidure\"}],[\"$\",\"meta\",\"21\",{\"name\":\"twitter:description\",\"content\":\"Pr√©sentation donn√©e lors du ChtiJS 21 √† propos de l'injection de d√©pendances en JavaScript.\"}],[\"$\",\"meta\",\"22\",{\"name\":\"twitter:image:alt\",\"content\":\"Banni√®re du site\"}],[\"$\",\"meta\",\"23\",{\"name\":\"twitter:image\",\"content\":\"https://insertafter.com/images/banner.png\"}],[\"$\",\"link\",\"24\",{\"rel\":\"icon\",\"href\":\"/images/favicon.svg\",\"type\":\"image/svg+xml\",\"sizes\":\"any\"}],[\"$\",\"link\",\"25\",{\"rel\":\"icon\",\"href\":\"/images/favicon-16.png\",\"type\":\"image/png\",\"sizes\":\"16x16\"}],[\"$\",\"link\",\"26\",{\"rel\":\"icon\",\"href\":\"/images/favicon-128.png\",\"type\":\"image/png\",\"sizes\":\"128x128\"}]]\n"])</script><script>self.__next_f.push([1,"5:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>